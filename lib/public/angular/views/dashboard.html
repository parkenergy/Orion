<div class="col-md-9">
  <div class="panel panel-default">
    <div class="panel-heading">
      <h3 class="panel-title">Filter By:</h3>
      <span class="pull-right clickable panel-collapsed"><i class="glyphicon glyphicon-chevron-down"></i></span>
    </div>
    <div class="panel-body workordersearch" style="display: none;">
      <form class="form-inline" role="form">
        <div class="form-group">
          <label for="contain">Unit Number</label>
          <input class="form-control" name="unitNumber" ng-model="searchWorkorders.unitNumber" type="text" />
        </div>
        <div class="form-group">
          <label for="contain">Technician</label>
          <input class="form-control" name="searchWorkorders" ng-model="searchWorkorders.techName" type="text" />
        </div>
        <div class="form-group">
          <label for="contain">Customer</label>
          <input class="form-control" name="customer" ng-model="searchWorkorders.customerName" type="text" />
        </div>
      </form>
    </div>
  </div>
</div>
<div class="col-md-3">
  <div class="panel panel-default">
    <div class="panel-heading">
      <h3 class="panel-title">Date Search:</h3>
      <span class="pull-right clickable panel-collapsed"><i class="glyphicon glyphicon-chevron-down"></i></span>
    </div>
    <div class="panel-body workordersearch" style="display: none;">
      <form class="form-inline">
        <div class="form-group">
          <label>From: </label>
          <input class="form-control"
                 ng-model="dates.from"
                 ng-change="startOfDay()"
                 name="fromDate" type="date"
                 placeholder="yyyy-MM-dd">

          <label>To: </label>
          <input class="form-control"
                 ng-model="dates.to"
                 ng-change="endOfDay()"
                 name="toDate"
                 type="date"
                 placeholder="yyyy-MM-dd">

          <button
            class="btn btn-primary form-inline"
            type="button"
            ng-click="submitDates()">
            Search
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<table class="table table-hover">

  <thead>
    <tr style="cursor: pointer">
      <th ng-click="resort('unitSort');">
        Unit #
        <span ng-show="orderByField == 'unitSort' && !reverseSort" class="glyphicon glyphicon-chevron-up"></span>
        <span ng-show="orderByField == 'unitSort' && reverseSort" class="glyphicon glyphicon-chevron-down"></span>
      </th>
      <th ng-click="resort('techName');">
        Tech
        <span ng-show="orderByField == 'techName' && !reverseSort" class="glyphicon glyphicon-chevron-up"></span>
        <span ng-show="orderByField == 'techName' && reverseSort" class="glyphicon glyphicon-chevron-down"></span>
      </th>
      <th ng-click="resort('orderType');">
        Type
        <span ng-show="orderByField == 'orderType' && !reverseSort" class="glyphicon glyphicon-chevron-up"></span>
        <span ng-show="orderByField == 'orderType' && reverseSort" class="glyphicon glyphicon-chevron-down"></span>
      </th>
      <th ng-click="resort('unit.locationName');">
        Location
        <span ng-show="orderByField == 'locationName' && !reverseSort" class="glyphicon glyphicon-chevron-up"></span>
        <span ng-show="orderByField == 'locationName' && reverseSort" class="glyphicon glyphicon-chevron-down"></span>
      </th>
      <th ng-click="resort('unit.customerName');">
        Customer
        <span ng-show="orderByField == 'customerName' && !reverseSort" class="glyphicon glyphicon-chevron-up"></span>
        <span ng-show="orderByField == 'customerName' && reverseSort" class="glyphicon glyphicon-chevron-down"></span>
      </th>
      <th ng-click="resort('epoch');">
        Imported Date
        <span ng-show="orderByField == 'epoch' && !reverseSort" class="glyphicon glyphicon-chevron-up"></span>
        <span ng-show="orderByField == 'epoch' && reverseSort" class="glyphicon glyphicon-chevron-down"></span>
      </th>
    </tr>
  </thead>

  <tbody infinite-scroll="loadOnScroll()" infinite-scroll-immediate-check="false" infinite-scroll-disabled="!loaded">
    <tr ng-repeat="workorder in workorders | orderBy:orderByField:reverseSort | filter:searchWorkorders" ng-click="clickWorkOrder();"
        style="color: {{workorder.status === 'APPROVED' ? '#9E9E9E' : 'inherit'}}; cursor: pointer">
      <td>{{ workorder.unitNumber }}</td>
      <td>{{ workorder.techName }}</td>
      <td>{{ workorder.orderType }}</td>
      <td>{{ workorder.locationName}}</td>
      <td>{{ workorder.customerName }}</td>
      <td>{{ workorder.updated_at | date:'MM/dd/yyyy HH:mm'}}</td>
    </tr>
  </tbody>

</table>
<script type="text/javascript">
  jQuery(function ($) {
    $('.panel-heading span.clickable').on("click", function (e) {
      if ($(this).hasClass('panel-collapsed')) {
        // expand the panel
        $(this).parents('.panel').children('.workordersearch').slideDown();
        $(this).removeClass('panel-collapsed');
        $(this).find('i').removeClass('glyphicon-chevron-down').addClass('glyphicon-chevron-up');
      }
      else {
        // collapse the panel
        $(this).parents('.panel').children('.workordersearch').slideUp();
        $(this).addClass('panel-collapsed');
        $(this).find('i').removeClass('glyphicon-chevron-up').addClass('glyphicon-chevron-down');
      }
    });
  });
</script>
